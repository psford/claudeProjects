name: Branch Guard

# Prevent merging master into develop (wrong direction)
# Correct flow: develop → PR → master (never the reverse)

on:
  pull_request:
    branches: [ develop ]

jobs:
  block-master-to-develop:
    runs-on: ubuntu-latest
    steps:
    - name: Check source branch
      run: |
        echo "PR from: ${{ github.head_ref }}"
        echo "PR to: ${{ github.base_ref }}"

        if [[ "${{ github.head_ref }}" == "master" || "${{ github.head_ref }}" == "main" ]]; then
          echo "::error::BLOCKED: Cannot merge master/main into develop. This is the wrong direction!"
          echo "::error::The correct flow is: develop → PR → master"
          exit 1
        fi

        echo "✓ Branch direction is valid"
